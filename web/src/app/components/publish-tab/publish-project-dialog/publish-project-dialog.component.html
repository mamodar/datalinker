<form #publishForm='ngForm'>
<mat-dialog-content>
  <p>
    <mat-form-field class="full-width">
      <mat-label>Projekt</mat-label>
      <input [(ngModel)]="data.title" matInput name="title" required>
    </mat-form-field>
  </p>
  <p>
    <mat-form-field class="full-width">
      <mat-label>Beschreibung</mat-label>
      <textarea [(ngModel)]="data.description" matInput name="description" required> </textarea>
    </mat-form-field>
  </p>
  <p>
    <mat-form-field *ngFor="let author of data.authors;let index = index;" class=quarter-width>
      <mat-label>Autor {{index + 1}}</mat-label>
      <input [(ngModel)]="data.authors[index].name" matInput
             [ngModelOptions]="{standalone: true, updateOn: 'blur'}"><br>
    </mat-form-field>
    <button class="button" color="primary" mat-mini-fab (click)="addAuthor()">+</button>
    <button class="button" *ngIf="data.authors.length>1" color="warn" mat-mini-fab (click)="removeAuthor()">-</button>
  </p>
  <p>
    <mat-form-field *ngFor="let author of data.authors;let index = index;" class=quarter-width>
      <mat-label>Zugehörigkeit {{index + 1}}</mat-label>
      <input [(ngModel)]="data.authors[index].affiliation" matInput
             [ngModelOptions]="{standalone: true, updateOn: 'blur'}"><br>
    </mat-form-field>

  </p>
  <p>
    <mat-form-field *ngFor="let keyword of data.keywords;let index = index;" class=quarter-width>
      <mat-label>Schlagwort</mat-label>
      <input [(ngModel)]="data.keywords[index]" matInput [ngModelOptions]="{standalone: true, updateOn: 'blur'}"><br>
    </mat-form-field>
    <button class="button" color="primary" mat-mini-fab (click)="addKeyword()">+</button>
    <button *ngIf="data.keywords.length>1" class="button" color="warn" mat-mini-fab (click)="removeKeyword()">-</button>
  </p>
  <p>
    <mat-form-field class=half-width>
      <mat-label>Lizenz</mat-label>
      <input [(ngModel)]="data.license" matInput name="license" required></mat-form-field>
  </p>
  <p>
    <mat-form-field appearance="fill" class="quarter-width">
      <mat-label>Ausgabedatum</mat-label>
      <input matInput [matDatepicker]="datepicker" disabled [(ngModel)]="data.issueDate" name="issueDate">
      <mat-datepicker-toggle matSuffix [for]="datepicker"></mat-datepicker-toggle>
      <mat-datepicker #datepicker disabled="false"></mat-datepicker>
    </mat-form-field>

  </p>

  <div class=half-width>
    <button (click)="fileInput.click()" mat-raised-button type="button">Datei(en) auswählen</button>
    <div class="mat-caption">(max. 50MB)</div>
    <input #fileInput (change)="uploadFile($event)" multiple hidden id="file" required type="file"><br>
    <div *ngIf="data.files" class="mat-caption">
      Anzahl: {{data.files.length}} Größe: {{fileSize(data.files)|number}}MB
    </div>
  </div>
</mat-dialog-content>
  <div mat-dialog-actions>
    <button
      [disabled]="publishForm.form.invalid || !this.data.files || !(this.data.files.length > 0) || (fileSize(data.files) > 50)"
      [mat-dialog-close]="{send: true , resource: data}" class="button"
      color="primary" mat-raised-button>
      Exportieren
    </button>
    <button [mat-dialog-close]="{send: false , resource: data}" class="button" color="warn" mat-raised-button>
      Abbrechen
    </button>

  </div>
</form>
